
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>barotropy.fluid_properties.low_level_interface module &#8212; barotropy v0.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=28af074a"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'source/api/barotropy.fluid_properties.low_level_interface';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="barotropy.pysolver_view package" href="barotropy.pysolver_view.html" />
    <link rel="prev" title="barotropy.fluid_properties.core module" href="barotropy.fluid_properties.core.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">barotropy v0.0.0 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials.html">Tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/one_component_systems.html">Tutorial: One-component systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/two_component_systems.html">Tutorial: Two-component systems</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../barotropic_model.html">Barotropic Model Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="modules.html">API Reference</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="barotropy.html">barotropy</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active has-children"><a class="reference internal" href="barotropy.fluid_properties.html">barotropy.fluid_properties package</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="barotropy.fluid_properties.core.html">barotropy.fluid_properties.core module</a></li>
<li class="toctree-l4 current active"><a class="current reference internal" href="#">barotropy.fluid_properties.low_level_interface module</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="barotropy.pysolver_view.html">barotropy.pysolver_view package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="barotropy.pysolver_view.nonlinear_system.html">barotropy.pysolver_view.nonlinear_system module</a></li>
<li class="toctree-l4"><a class="reference internal" href="barotropy.pysolver_view.nonlinear_system_problems.html">barotropy.pysolver_view.nonlinear_system_problems module</a></li>
<li class="toctree-l4"><a class="reference internal" href="barotropy.pysolver_view.numerical_differentiation.html">barotropy.pysolver_view.numerical_differentiation module</a></li>
<li class="toctree-l4"><a class="reference internal" href="barotropy.pysolver_view.optimization.html">barotropy.pysolver_view.optimization module</a></li>
<li class="toctree-l4"><a class="reference internal" href="barotropy.pysolver_view.optimization_problems.html">barotropy.pysolver_view.optimization_problems module</a></li>
<li class="toctree-l4"><a class="reference internal" href="barotropy.pysolver_view.optimization_wrappers.html">barotropy.pysolver_view.optimization_wrappers module</a></li>
<li class="toctree-l4"><a class="reference internal" href="barotropy.pysolver_view.pysolver_utilities.html">barotropy.pysolver_view.pysolver_utilities module</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="barotropy.fluent_automation.html">barotropy.fluent_automation package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="barotropy.fluent_automation.fluent_automation.html">barotropy.fluent_automation.fluent_automation module</a></li>
<li class="toctree-l4"><a class="reference internal" href="barotropy.fluent_automation.fluent_plot_nozzle_data.html">barotropy.fluent_automation.fluent_plot_nozzle_data module</a></li>
<li class="toctree-l4"><a class="reference internal" href="barotropy.fluent_automation.stream_residuals.html">barotropy.fluent_automation.stream_residuals module</a></li>
<li class="toctree-l4"><a class="reference internal" href="barotropy.fluent_automation.stream_transcript.html">barotropy.fluent_automation.stream_transcript module</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="barotropy.barotropic_model.html">barotropy.barotropic_model module</a></li>
<li class="toctree-l3"><a class="reference internal" href="barotropy.isentropic_nozzle.html">barotropy.isentropic_nozzle module</a></li>
<li class="toctree-l3"><a class="reference internal" href="barotropy.sCO2_utilities.html">barotropy.sCO2_utilities module</a></li>
<li class="toctree-l3"><a class="reference internal" href="barotropy.math.html">barotropy.math module</a></li>
<li class="toctree-l3"><a class="reference internal" href="barotropy.plot_options.html">barotropy.plot_options module</a></li>
<li class="toctree-l3"><a class="reference internal" href="barotropy.utilities.html">barotropy.utilities module</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/source/api/barotropy.fluid_properties.low_level_interface.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>barotropy.fluid_properties.low_level_interface module</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.calculate_generalized_quality"><code class="docutils literal notranslate"><span class="pre">calculate_generalized_quality()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.calculate_subcooling"><code class="docutils literal notranslate"><span class="pre">calculate_subcooling()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.calculate_superheating"><code class="docutils literal notranslate"><span class="pre">calculate_superheating()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.compute_properties_1phase"><code class="docutils literal notranslate"><span class="pre">compute_properties_1phase()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.compute_properties_2phase"><code class="docutils literal notranslate"><span class="pre">compute_properties_2phase()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.compute_properties_metastable"><code class="docutils literal notranslate"><span class="pre">compute_properties_metastable()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.compute_properties_metastable_rhoT"><code class="docutils literal notranslate"><span class="pre">compute_properties_metastable_rhoT()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.compute_spinodal_point"><code class="docutils literal notranslate"><span class="pre">compute_spinodal_point()</span></code></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-barotropy.fluid_properties.low_level_interface">
<span id="barotropy-fluid-properties-low-level-interface-module"></span><h1>barotropy.fluid_properties.low_level_interface module<a class="headerlink" href="#module-barotropy.fluid_properties.low_level_interface" title="Link to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="barotropy.fluid_properties.low_level_interface.calculate_generalized_quality">
<span class="sig-prename descclassname"><span class="pre">barotropy.fluid_properties.low_level_interface.</span></span><span class="sig-name descname"><span class="pre">calculate_generalized_quality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abstract_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/barotropy/fluid_properties/low_level_interface.html#calculate_generalized_quality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#barotropy.fluid_properties.low_level_interface.calculate_generalized_quality" title="Link to this definition">#</a></dt>
<dd><p>Calculate the generalized quality of a fluid, extending the quality calculation beyond the two-phase region if necessary.</p>
<p>Below the critical temperature, the quality is calculated from the specific volume of the saturated liquid and vapor states.
Above the critical temperature, an artificial two-phase region is defined around the critical density line to allow for a finite-width quality computation.</p>
<p>The quality, <span class="math notranslate nohighlight">\(Q\)</span>, is given by:</p>
<div class="math notranslate nohighlight">
\[Q = \frac{v - v(T, Q=0)}{v(T, Q=1) - v(T, Q=0)}\]</div>
<p>where <span class="math notranslate nohighlight">\(v=1/\rho\)</span> is the specific volume and <span class="math notranslate nohighlight">\(T\)</span> is the temperature.</p>
<p>Additionally, this function applies smoothing limiters to ensure the quality is bounded between -1 and 2.
These limiters prevent the quality value from taking arbitrarily large values, enhancing stability and robustness of downstream calculation.
The limiters use the <cite>logsumexp</cite> method for smooth transitions, with a specified alpha value controlling the smoothness.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>abstract_state</strong><span class="classifier">CoolProp.AbstractState</span></dt><dd><p>CoolProp abstract state of the fluid.</p>
</dd>
<dt><strong>alpha</strong><span class="classifier">float</span></dt><dd><p>Smoothing factor of the quality-calculation limiters.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float</dt><dd><p>The calculated quality of the fluid.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="barotropy.fluid_properties.low_level_interface.calculate_subcooling">
<span class="sig-prename descclassname"><span class="pre">barotropy.fluid_properties.low_level_interface.</span></span><span class="sig-name descname"><span class="pre">calculate_subcooling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abstract_state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/barotropy/fluid_properties/low_level_interface.html#calculate_subcooling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#barotropy.fluid_properties.low_level_interface.calculate_subcooling" title="Link to this definition">#</a></dt>
<dd><p>Calculate the degree of subcooling for a given CoolProp abstract state.</p>
<p>This function computes the subcooling of a fluid using the CoolProp library’s
abstract state class. It handles both subcritical and supercritical conditions
to provide a measure of subcooling for any thermodynamic state. This results in
a continuous variation of subcooling in the two-phase region, which is necessary
to achieve reliable convergence of systems of equations and optimization problems
involving the degree of subcooling.</p>
<dl>
<dt>Calculation cases:</dt><dd><ul class="simple">
<li><p>Physically meaningful subcooling for subcritical states in the liquid region:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\Delta T = T(p, Q=0) - T \quad \text{for} \quad h &lt; h(p, Q=0)\]</div>
<ul class="simple">
<li><p>Artificial subcooling for subcritical states in the vapor and two-phase regions:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\Delta T = \frac{h(p, Q=0) - h}{c_p(p, Q=0)}\]</div>
<ul class="simple">
<li><p>Artificial subcooling for supercritical states defined using the critical density line:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\Delta T = T(p, \rho_{\text{crit}}) - T\]</div>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>abstract_state</strong><span class="classifier">CoolProp.AbstractState</span></dt><dd><p>The abstract state of the fluid for which the subcooling is to be calculated.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float</dt><dd><p>The degree of subcooling in Kelvin.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">CoolProp</span> <span class="k">as</span> <span class="nn">CP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abstract_state</span> <span class="o">=</span> <span class="n">CP</span><span class="o">.</span><span class="n">AbstractState</span><span class="p">(</span><span class="s2">&quot;HEOS&quot;</span><span class="p">,</span> <span class="s2">&quot;water&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abstract_state</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">CP</span><span class="o">.</span><span class="n">PT_INPUTS</span><span class="p">,</span> <span class="mi">101325</span><span class="p">,</span> <span class="mi">25</span><span class="o">+</span><span class="mf">273.15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subcooling</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">calculate_subcooling</span><span class="p">(</span><span class="n">abstract_state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subcooling is </span><span class="si">{</span><span class="n">subcooling</span><span class="si">:</span><span class="s2">+0.3f</span><span class="si">}</span><span class="s2"> K&quot;</span><span class="p">)</span>
<span class="go">Subcooling is +74.974 K</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">abstract_state</span> <span class="o">=</span> <span class="n">CP</span><span class="o">.</span><span class="n">AbstractState</span><span class="p">(</span><span class="s2">&quot;HEOS&quot;</span><span class="p">,</span> <span class="s2">&quot;water&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abstract_state</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">CP</span><span class="o">.</span><span class="n">PQ_INPUTS</span><span class="p">,</span> <span class="mi">101325</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subcooling</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">calculate_subcooling</span><span class="p">(</span><span class="n">abstract_state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subcooling is </span><span class="si">{</span><span class="n">subcooling</span><span class="si">:</span><span class="s2">+0.3f</span><span class="si">}</span><span class="s2"> K&quot;</span><span class="p">)</span>
<span class="go">Subcooling is -26.763 K</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="barotropy.fluid_properties.low_level_interface.calculate_superheating">
<span class="sig-prename descclassname"><span class="pre">barotropy.fluid_properties.low_level_interface.</span></span><span class="sig-name descname"><span class="pre">calculate_superheating</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abstract_state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/barotropy/fluid_properties/low_level_interface.html#calculate_superheating"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#barotropy.fluid_properties.low_level_interface.calculate_superheating" title="Link to this definition">#</a></dt>
<dd><p>Calculate the degree of superheating for a given CoolProp abstract state.</p>
<p>This function computes the superheating of a fluid using the CoolProp library’s
abstract state class. It handles both subcritical and supercritical conditions
to provide a measure of superheating for any thermodynamic state. This results in
a continuous variation of superheating in the two-phase region, which is necessary
to achieve in reliable convergence of systems of equations and optimization problems
involving the degree of superheating.</p>
<dl>
<dt>Calculation cases:</dt><dd><ul class="simple">
<li><p>Physically meaningful superheating for subcritical states in the vapor region:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\Delta T = T - T(p, Q=1) \quad \text{for} \quad h &gt; h(p, Q=1)\]</div>
<ul class="simple">
<li><p>Artificial superheating for subcritical states in the liquid and two-phase regions:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\Delta T = \frac{h - h(p, Q=1)}{c_p(p, Q=1)}\]</div>
<ul class="simple">
<li><p>Artificial superheating for supercritical states defined using the critical density line:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\Delta T = T - T(p, \rho_{\text{crit}})\]</div>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>abstract_state</strong><span class="classifier">CoolProp.AbstractState</span></dt><dd><p>The abstract state of the fluid for which the superheating is to be calculated.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float</dt><dd><p>The degree of superheating in Kelvin.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">CoolProp</span> <span class="k">as</span> <span class="nn">CP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abstract_state</span> <span class="o">=</span> <span class="n">CP</span><span class="o">.</span><span class="n">AbstractState</span><span class="p">(</span><span class="s2">&quot;HEOS&quot;</span><span class="p">,</span> <span class="s2">&quot;water&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abstract_state</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">CP</span><span class="o">.</span><span class="n">PT_INPUTS</span><span class="p">,</span> <span class="mi">101325</span><span class="p">,</span> <span class="mi">120</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">superheating</span> <span class="o">=</span> <span class="n">calculate_superheating</span><span class="p">(</span><span class="n">abstract_state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Superheating is </span><span class="si">{</span><span class="n">superheating</span><span class="si">:</span><span class="s2">+0.3f</span><span class="si">}</span><span class="s2"> K&quot;</span><span class="p">)</span>
<span class="go">Superheating is +20.026 K</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">abstract_state</span> <span class="o">=</span> <span class="n">CP</span><span class="o">.</span><span class="n">AbstractState</span><span class="p">(</span><span class="s2">&quot;HEOS&quot;</span><span class="p">,</span> <span class="s2">&quot;water&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abstract_state</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">CP</span><span class="o">.</span><span class="n">PQ_INPUTS</span><span class="p">,</span> <span class="mi">101325</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">superheating</span> <span class="o">=</span> <span class="n">calculate_superheating</span><span class="p">(</span><span class="n">abstract_state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Superheating is </span><span class="si">{</span><span class="n">superheating</span><span class="si">:</span><span class="s2">+0.3f</span><span class="si">}</span><span class="s2"> K&quot;</span><span class="p">)</span>
<span class="go">Superheating is -54.244 K</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="barotropy.fluid_properties.low_level_interface.compute_properties_1phase">
<span class="sig-prename descclassname"><span class="pre">barotropy.fluid_properties.low_level_interface.</span></span><span class="sig-name descname"><span class="pre">compute_properties_1phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abstract_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generalize_quality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_subcooling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_superheating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/barotropy/fluid_properties/low_level_interface.html#compute_properties_1phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#barotropy.fluid_properties.low_level_interface.compute_properties_1phase" title="Link to this definition">#</a></dt>
<dd><p>Get single-phase properties from CoolProp low level interface</p>
<p>Direct call to coolprop</p>
<p>TODO To be completed</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="barotropy.fluid_properties.low_level_interface.compute_properties_2phase">
<span class="sig-prename descclassname"><span class="pre">barotropy.fluid_properties.low_level_interface.</span></span><span class="sig-name descname"><span class="pre">compute_properties_2phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abstract_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_subcooling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_superheating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/barotropy/fluid_properties/low_level_interface.html#compute_properties_2phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#barotropy.fluid_properties.low_level_interface.compute_properties_2phase" title="Link to this definition">#</a></dt>
<dd><p>Get two-phase properties from mixing rules and single-phase CoolProp properties</p>
<p>Homogeneous equilibrium model</p>
<p>State formulas for T=T, p=p, mfrac/vfrac(rho), h-s-g-u-cp-cv, mu-k, a
TODO To be completed</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="barotropy.fluid_properties.low_level_interface.compute_properties_metastable">
<span class="sig-prename descclassname"><span class="pre">barotropy.fluid_properties.low_level_interface.</span></span><span class="sig-name descname"><span class="pre">compute_properties_metastable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abstract_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_1_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_2_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hybr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_convergence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/barotropy/fluid_properties/low_level_interface.html#compute_properties_metastable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#barotropy.fluid_properties.low_level_interface.compute_properties_metastable" title="Link to this definition">#</a></dt>
<dd><p>Determine the thermodynamic state for the given fluid property pair by iterating on the 
density-temperature native inputs of the Helmholtz energy equations of state.</p>
<p>This function uses a non-linear root finder to determine the solution of the nonlinear system given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}R_1(\rho,\, T) = y_1 - y_1(\rho,\, T) = 0 \\
R_2(\rho,\, T) = y_2 - y_2(\rho,\, T) = 0\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\((y_1,\, y_2)\)</span> is the given thermodynamic property pair (e.g., enthalpy and pressure),
while density and temperature <span class="math notranslate nohighlight">\((\rho,\, T)\)</span> are the independent variables that the solver 
iterates until the residual of the problem is driven to zero. The calculations <span class="math notranslate nohighlight">\(y_1(\rho,\, T)\)</span> and
<span class="math notranslate nohighlight">\(y_1(\rho,\, T)\)</span> are performed by evaluating the Helmholtz energy equation of state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>prop_1</strong><span class="classifier">str</span></dt><dd><p>The the type of the first thermodynamic property.</p>
</dd>
<dt><strong>prop_1_value</strong><span class="classifier">float</span></dt><dd><p>The the numerical value of the first thermodynamic property.</p>
</dd>
<dt><strong>prop_2</strong><span class="classifier">str</span></dt><dd><p>The the type of the second thermodynamic property.</p>
</dd>
<dt><strong>prop_2_value</strong><span class="classifier">float</span></dt><dd><p>The the numerical value of the second thermodynamic property.</p>
</dd>
<dt><strong>rho_guess</strong><span class="classifier">float</span></dt><dd><p>Initial guess for density</p>
</dd>
<dt><strong>T_guess</strong><span class="classifier">float</span></dt><dd><p>Initial guess for temperature</p>
</dd>
<dt><strong>method</strong><span class="classifier">str, optional</span></dt><dd><p>Method to be used for solving the nonlinear system. Available solvers are:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">hybr</span></code>:  Uses MINPACK’s ‘hybrd’ method, which is is a modification of Powell’s hybrid method (default).</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">lm</span></code>: The Levenberg-Marquardt method, which blends the steepest descent and the Gauss-Newton methods.</p></li>
</ul>
</dd>
<dt><strong>tolerance</strong><span class="classifier">float, optional</span></dt><dd><p>Tolerance for the solver termination. Defaults to 1e-6.</p>
</dd>
<dt><strong>print_convergence</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, displays the convergence progress. Defaults to False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>dict</dt><dd><p>Thermodynamic properties corresponding to the given input pair.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#barotropy.fluid_properties.low_level_interface.compute_properties_metastable_rhoT" title="barotropy.fluid_properties.low_level_interface.compute_properties_metastable_rhoT"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_properties_metastable_rhoT()</span></code></a></dt><dd><p>Evaluation of Helmholtz energy equation of state.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="barotropy.fluid_properties.low_level_interface.compute_properties_metastable_rhoT">
<span class="sig-prename descclassname"><span class="pre">barotropy.fluid_properties.low_level_interface.</span></span><span class="sig-name descname"><span class="pre">compute_properties_metastable_rhoT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abstract_state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/barotropy/fluid_properties/low_level_interface.html#compute_properties_metastable_rhoT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#barotropy.fluid_properties.low_level_interface.compute_properties_metastable_rhoT" title="Link to this definition">#</a></dt>
<dd><p>Compute the thermodynamic properties of a fluid using temperature-density calls to the Helmholtz energy equation of state (HEOS).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>rho</strong><span class="classifier">float</span></dt><dd><p>Density of the fluid (kg/m³).</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the fluid (K).</p>
</dd>
<dt><strong>abstract_state</strong><span class="classifier">CoolProp.AbstractState</span></dt><dd><p>The abstract state of the fluid for which the properties are to be calculated.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>dict</dt><dd><p>Thermodynamic properties computed at the given density and temperature.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The Helmholtz energy equation of state (HEOS) expresses the Helmholtz energy as an explicit function 
of temperature and density:</p>
<div class="math notranslate nohighlight">
\[\Phi = \Phi(\rho, T)\]</div>
<p>In dimensionless form, the Helmholtz energy is given by:</p>
<div class="math notranslate nohighlight">
\[\phi(\delta, \tau) = \frac{\Phi(\delta, \tau)}{R T}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\phi\)</span> is the dimensionless Helmholtz energy</p></li>
<li><p><span class="math notranslate nohighlight">\(R\)</span> is the gas constant of the fluid</p></li>
<li><p><span class="math notranslate nohighlight">\(\delta = \rho / \rho_c\)</span> is the reduced density</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau = T_c / T\)</span> is the inverse of the reduced temperature</p></li>
</ul>
<p>Thermodynamic properties can be derived from the Helmholtz energy and its partial derivatives. 
The following table summarizes the expressions for various properties:</p>
<div class="pst-scrollable-table-container"><table class="table" id="id3">
<caption><span class="caption-text">Helmholtz energy thermodynamic relations</span><a class="headerlink" href="#id3" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Mathematical relation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Pressure</p></td>
<td><div class="math notranslate nohighlight">
\[Z = \frac{p}{\rho R T} = \delta \cdot \phi_{\delta}\]</div>
</td>
</tr>
<tr class="row-odd"><td><p>Entropy</p></td>
<td><div class="math notranslate nohighlight">
\[\frac{s}{R} = \tau \cdot \phi_{\tau} - \phi\]</div>
</td>
</tr>
<tr class="row-even"><td><p>Internal energy</p></td>
<td><div class="math notranslate nohighlight">
\[\frac{u}{R T} = \tau \cdot \phi_{\tau}\]</div>
</td>
</tr>
<tr class="row-odd"><td><p>Enthalpy</p></td>
<td><div class="math notranslate nohighlight">
\[\frac{h}{R T} = \tau \cdot \phi_{\tau} + \delta \cdot \phi_{\delta}\]</div>
</td>
</tr>
<tr class="row-even"><td><p>Isochoric heat capacity</p></td>
<td><div class="math notranslate nohighlight">
\[\frac{c_v}{R} = -\tau^2 \cdot \phi_{\tau \tau}\]</div>
</td>
</tr>
<tr class="row-odd"><td><p>Isobaric heat capacity</p></td>
<td><div class="math notranslate nohighlight">
\[\frac{c_p}{R} = -\tau^2 \cdot \phi_{\tau \tau} + \frac{(\delta \cdot \phi_{\delta} - \tau \cdot \delta \cdot \phi_{\tau \delta})^2}{2 \cdot \delta \cdot \phi_{\delta} + \delta^2 \cdot \phi_{\delta \delta}}\]</div>
</td>
</tr>
<tr class="row-even"><td><p>Isobaric expansivity</p></td>
<td><div class="math notranslate nohighlight">
\[\alpha \cdot T = \frac{\delta \cdot \phi_{\delta} - \tau \cdot \delta \cdot \phi_{\tau \delta}}{2 \cdot \delta \cdot \phi_{\delta} + \delta^2 \cdot \phi_{\delta \delta}}\]</div>
</td>
</tr>
<tr class="row-odd"><td><p>Isothermal compressibility</p></td>
<td><div class="math notranslate nohighlight">
\[\rho R T \beta = \left(2 \cdot \delta \cdot \phi_{\delta} + \delta^2 \cdot \phi_{\delta \delta} \right)^{-1}\]</div>
</td>
</tr>
<tr class="row-even"><td><p>Isothermal bulk modulus</p></td>
<td><div class="math notranslate nohighlight">
\[\frac{K_T}{\rho R T} = 2 \cdot \delta \cdot \phi_{\delta} + \delta^2 \cdot \phi_{\delta \delta}\]</div>
</td>
</tr>
<tr class="row-odd"><td><p>Isentropic bulk modulus</p></td>
<td><div class="math notranslate nohighlight">
\[\frac{K_s}{\rho R T} = 2 \cdot \delta \cdot \phi_{\delta} + \delta^2 \ \cdot \phi_{\delta \delta} - \frac{(\delta \cdot \phi_{\delta} - \tau \cdot \delta \cdot \phi_{\tau \delta})^2}{\tau^2 \cdot \phi_{\tau \tau}}\]</div>
</td>
</tr>
<tr class="row-even"><td><p>Joule-Thompson coefficient</p></td>
<td><div class="math notranslate nohighlight">
\[\rho R \mu_{\mathrm{JT}} = - \frac{\delta \cdot \phi_{\delta} + \tau \cdot \delta \cdot \phi_{\tau \delta} + \delta^2 \cdot \phi_{\delta \delta}}{(\delta \cdot \phi_{\delta} - \tau \cdot \delta \cdot \phi_{\tau \delta})^2 - \tau^2 \cdot \phi_{\tau \tau} \cdot (2 \cdot \delta \cdot \phi_{\delta} + \delta^2 \cdot \phi_{\delta \delta})}\]</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>Where the following abbreviations are used:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\phi_{\delta} = \left(\frac{\partial \phi}{\partial \delta}\right)_{\tau}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\phi_{\tau} = \left(\frac{\partial \phi}{\partial \tau}\right)_{\delta}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\phi_{\delta \delta} = \left(\frac{\partial^2 \phi}{\partial \delta^2}\right)_{\tau, \tau}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\phi_{\tau \tau} = \left(\frac{\partial^2 \phi}{\partial \tau^2}\right)_{\delta, \delta}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\phi_{\tau \delta} = \left(\frac{\partial^2 \phi}{\partial \tau \delta}\right)_{\delta, \tau}\)</span></p></li>
</ul>
<p>This function can be used to estimate metastable properties using the equation of state beyond the saturation lines.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="barotropy.fluid_properties.low_level_interface.compute_spinodal_point">
<span class="sig-prename descclassname"><span class="pre">barotropy.fluid_properties.low_level_interface.</span></span><span class="sig-name descname"><span class="pre">compute_spinodal_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abstract_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'liquid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_trial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/barotropy/fluid_properties/low_level_interface.html#compute_spinodal_point"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#barotropy.fluid_properties.low_level_interface.compute_spinodal_point" title="Link to this definition">#</a></dt>
<dd><p>Compute the vapor or liquid spinodal point of a fluid at a given temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the fluid (K).</p>
</dd>
<dt><strong>abstract_state</strong><span class="classifier">CoolProp.AbstractState</span></dt><dd><p>The abstract state of the fluid for which the spinodal point is to be calculated.</p>
</dd>
<dt><strong>branch</strong><span class="classifier">str, optional</span></dt><dd><p>Branch of the spinodal line used to determine the density initial guess.
Options: ‘liquid’ or ‘vapor’. Default is ‘liquid’.</p>
</dd>
<dt><strong>N_trial</strong><span class="classifier">int, optional</span></dt><dd><p>Number of trial points to generate the density initial guess. Default is 50.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>dict</dt><dd><p>Thermodynamic properties at the spinodal point.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If the input temperature is higher than the critical temperature or lower than
the triple temperature.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>When a single-phase fluid undergoes a thermodynamic process and enters the two-phase region it 
can exist in a single-phase state that is different from the equilibrium two-phase state. 
Such states are know as metastable states and they are only possible in the thermodynamic 
region between the saturation lines and the spinodal lines. If the thermodynamic process
continues and crosses the spinodal lines metastable states become unstable and the transition
to two-distinct phase occurs rapidly. Therefore, the spinodal line represents the locus of points
that separates the region where a mixture is thermodynamically unstable and prone to phase separation
from the region where metastable states are physically possible.</p>
<p>In mathematical terms, the spinodal line is defined as the loci of thermodynamic states in which the isothermal bulk modulus of the fluid is zero:</p>
<div class="math notranslate nohighlight">
\[K_T = \rho \left( \frac{\partial p}{\partial \rho} \right)_T = 0\]</div>
<p>More precisely, a vapor spinodal point is the first local maximum of a isotherm line in a pressure-density diagram as the density increases.
Conversely, a liquid spinodal point is the first local minimum of a isotherm line in a pressure-density diagram as the density decreases. 
The spinodal lines and phase envelope of carbon dioxide according to the HEOS developed by <span id="id1">[<a class="reference internal" href="../bibliography.html#id38" title="Roland Span and Wolfgang Wagner. A new equation of state for carbon dioxide covering the fluid region from the triple‐point temperature to 1100 K at pressures up to 800 MPa. Journal of Physical and Chemical Reference Data, 25(6):1509–1596, 1996. Publisher: American Institute of Physics. doi:10.1063/1.555991.">Span and Wagner, 1996</a>]</span> are illustrated in the figure below</p>
<img alt="Pressure-density diagram and spinodal points for carbon dioxide." src="../../_images/spinodal_points_CO2.svg" /><p>Some equations of state are not well-posed and do not satisfy the condition <span class="math notranslate nohighlight">\(K_T=0\)</span> within the two-phase region.
This is exemplified by the nitrogen HEOS developed by <span id="id2">[<a class="reference internal" href="../bibliography.html#id39" title="Roland Span, Eric W. Lemmon, Richard T Jacobsen, Wolfgang Wagner, and Akimichi Yokozeki. A reference equation of state for the thermodynamic properties of nitrogen for temperatures from 63.151 to 1000 K and pressures to 2200 MPa. Journal of Physical and Chemical Reference Data, 29(6):1361–1433, 2000. doi:10.1063/1.1349047.">Span <em>et al.</em>, 2000</a>]</span>.</p>
<img alt="Pressure-density diagram and &quot;pseudo&quot; spinodal points for carbon dioxide." src="../../_images/spinodal_points_nitrogen.svg" /><p>As seen in the figure, this HEOS is not well-posed because there are isotherms that do not have a local minimum/maximum corresponding to a state with zero isothermal bulk modulus.
In such cases, this function returns the inflection point of the isotherms (corresponding to the point closest to zero bulk modulus) as the spinodal point.</p>
</dd></dl>

</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="barotropy.fluid_properties.core.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">barotropy.fluid_properties.core module</p>
      </div>
    </a>
    <a class="right-next"
       href="barotropy.pysolver_view.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">barotropy.pysolver_view package</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.calculate_generalized_quality"><code class="docutils literal notranslate"><span class="pre">calculate_generalized_quality()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.calculate_subcooling"><code class="docutils literal notranslate"><span class="pre">calculate_subcooling()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.calculate_superheating"><code class="docutils literal notranslate"><span class="pre">calculate_superheating()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.compute_properties_1phase"><code class="docutils literal notranslate"><span class="pre">compute_properties_1phase()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.compute_properties_2phase"><code class="docutils literal notranslate"><span class="pre">compute_properties_2phase()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.compute_properties_metastable"><code class="docutils literal notranslate"><span class="pre">compute_properties_metastable()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.compute_properties_metastable_rhoT"><code class="docutils literal notranslate"><span class="pre">compute_properties_metastable_rhoT()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#barotropy.fluid_properties.low_level_interface.compute_spinodal_point"><code class="docutils literal notranslate"><span class="pre">compute_spinodal_point()</span></code></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Roberto Agromayor
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023, Sustainable Thermal Power DTU.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>